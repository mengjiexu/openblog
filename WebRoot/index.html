<!DOCTYPE html>
<html>
<head>
<title>博客</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="Blog" />

<link href="css/bootstrap.css" rel='stylesheet' type='text/css' />
<link href="css/style.css" rel="stylesheet" type="text/css" media="all" />
<link rel="stylesheet" href="css/loading.css" />
</head>
<body>
	<!--导航栏-->
<div class="header">
  <div class="header-bottom">
	<div class="navigation">
	  <nav class="navbar navbar-default" role="navigation">
	    <div class="wrap">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#collapse-1">
					<span class="sr-only">T</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
			</div>
		
			<div class="collapse navbar-collapse" id="collapse-1">
			  <ul class="nav navbar-nav">
					 <li><a href="index.html">首页</a></li>
					 <li><a href="javascript:void(0);" onclick="loadGreatBlog()">精选</a></li>
					 <li id="login"><a data-toggle="modal" data-target="#sigModal">登陆</a></li>
					 <li id="selfinfo" class="dropdown" style="display:none;">
						<a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown">个人中心<b class="caret"></b></a>
						<ul class="dropdown-menu">
							<li><a href="./person.html">个人信息</a></li>
							<li class="divider"></li>
							<li><a href="./writeBlog.html">书写博客</a></li>
							<li class="divider"></li>
							<li><a href="./myBlog.html">管理博客</a></li>
							<li class="divider"></li>
							<li><a href="javascript:void(0);" onClick="logout();">退出</a></li>
						</ul>
					  </li>
				</ul>
				<div class="search">
				    <div class="search-box">
					    <div id="sb-search" class="sb-search">
							<form>
								<input id="key" class="sb-search-input" placeholder="搜索" type="search" name="search" id="search">
								<span class="sb-icon-search"></span>
							</form>
						</div>
				    </div>
				</div>
			</div>
		</div>
	  </div>
    </nav>
  </div>
</div>
<!-- end  导航栏 -->
	<div class="wrap">
		<div class="move-text">
			<div class="marquee">
				<div class="marquee1">&nbsp;</div>
			</div>
		</div>
	</div>
	
	<!-- content -->
	<div class="main-body">
	  <div class="wrap">
		 <div class="col-md-8 content-left">
		    <div id="blogList" class="articles sports"></div>
				<ul class="pager">
				  <li><a onclick="loadUpPage()">上一页</a></li>
				  <li><a onclick="loadNextPage()">下一页</a></li>
				</ul>
			</div>
			<div class="col-md-4 side-bar">
					 <div class="popular-news">
						<header>
							<h3 class="title-popular">标签</h3>
						</header>
						<div class="popular-grids">
						  <div class="categories">
							<ul id="tagList"></ul>
				          </div>
						</div>
					</div>
						<div class="newsletter">
					<h1 class="side-title-head">添加新标签</h1>
					<p class="sign">如果上述没有你想找的标签，。。。。。</p>
					<form action="">
						<input type="text" class="text" placeholder="用户暂时不能添加标签">
						<input type="submit" value="添加">
					</form>
				</div>
					<div class="clearfix"></div>
			</div>
			<div class="clearfix"></div>
		</div>
	</div>
	
	<!-- content--end-->

	<!-- footer--starts-->
	<div class="footer">
		<div class="footer-bottom">
			<div class="text-center">
			   <p style="color: white;">Copyright &copy;开源博客开发小组</p>
			</div>
		</div>
	</div>
	
   <div class="modal fade" id="sigModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
     <div class="modal-dialog">
      <div class="modal-content">
         <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h3>&nbsp;</h3>
         </div>
         
          <div class="modal-body" style="background-color: #edeff1;">
			<div class="row">
				<!--登陆-->
			  <div class="col-md-6">
			  	<div id="loginByPass">
				 <div class="text-center">
				   <img src='img/face.ico' alt='人脸登录' onclick="loginByFace()"/>
			     </div>
				 <div class="form-group">
				    <label for="Email">邮箱</label>
				    <input type="email" class="form-control" id="userEmail" placeholder="email">
				  </div>
				  <div class="form-group">
				    <label for="Password">密码</label>
				    <input type="password" class="form-control" id="userPassword" placeholder="Password">
				  </div>
				  <div id="loginMessage"></div>
				  <button class="btn btn-primary btn-block" onclick="doLogin()">登录</button>
				  </div>
				  <div id="loginByFace" class="form-group" style="margin-top:10px; display: none;">
				  <div style="background-color: #000000; border: groove; height:185px;width: 100%; margin-bottom: 10px;">
				   </div> 
				   <button class="btn btn-default btn-block" onclick="canelFace()">取消</button>
				  </div>
				</div>
				<!--注册-->
				<div class="col-md-6" style="border-left: 2px solid white;">
					<div id="register">
				  <div class="text-center" style="padding: 5px 0 10px 0;">
				   <h3>注册</h3>
			      </div>
			      
			      <div class="form-group">
				  	<div id="re_email_message"></div>
				    <div class="input-group">
				      <div class="input-group-addon">
				      	<i class="glyphicon glyphicon-cloud"></i>
				      </div>
				      <input id="re_email" class="form-control" type="text" placeholder="email">
				    </div>
				   </div>
			      
				  <div class="form-group">
				  	<div id="re_name_message"></div>
				    <div class="input-group">
				      <div class="input-group-addon">
				      	<i class="glyphicon glyphicon-user"></i>
				      </div>
				      <input id="re_name" class="form-control" type="text" placeholder="用户名">
				    </div>
				   </div>
				  
				   <div class="form-group">
				    <div id="re_password_message"></div>
				    <div class="input-group">
				      <div class="input-group-addon">
				      	<i class="glyphicon glyphicon-lock"></i>
				      </div>
				      <input id="re_password" class="form-control" type="password" placeholder="密码(8~16位)">
				    </div>
				  </div>
			      <button class="btn btn-danger btn-block" onclick="doRegister()">注册</button>
			      </div>
			      <div id="findPass" style="display: none;">
			       <div class="text-center">
				   <h4>找回密码</h4>
			     </div>
				 <div class="form-group">
				    <label for="Email">邮箱</label>
				    <input type="email" class="form-control" id="find_Email" placeholder="email">
				  </div>
				  <button class="btn btn-success" onclick="subFind()">找回</button>
				  <button class="btn btn-default" onclick="cancelFind()">取消</button>
				  
				  </div>
				</div>
			</div>
         </div>
         <div  class="modal-footer">
          <button class="btn btn-default pull-left" onclick="doFind()">忘记密码?</button>
         </div>
      </div>
   </div>
   </div>
</body>
<script src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/bootstrap.js"></script>
<script src="js/classie.js"></script>
<script src="js/uisearch.js"></script>
<script type="text/javascript" src="js/sigin.js" ></script>
<script type="text/javascript">
$(document).ready(function(){
  //生成一个搜索框
  new UISearch( document.getElementById( 'sb-search' ));
  loadTags();
  loadBlog();
});


var pageid=1;
function loadBlog(){
	$("#blogList").empty();
	var search = GetUrlParms()["search"];
	if(search!=null){
		$.getJSON("./article_getarticlesbykeyword?keyword="+search,
			function(data){
				for(var i=0;i<data.length;i++){
					var dianzantimes=0;
					$.get("./article_getdianzan?aid="+data[i].aid,null,function(data){
						dianzantimes = data;
					});
					$("#blogList").append("<div class='article'><div class='article-left'>"
					  +"<img src='images/t2.jpg'></div>"
					  +"<div class='article-right'>"
					  +"<div class='article-title'>"
					  +"<a class='title' href='content.html?aid="+data[i].aid+"&userid="+data[i].uid+"'>"+data[i].title+"</a></div>"
					  +"<div class='article-text'>"
					  +"<p>"+data[i].content+"</p>"
					  +"<p>On "+data[i].time.replace("T"," ")+"</p>" 
					  +"<span class='glyphicon glyphicon-comment'></span>2"
					  +"<span class='glyphicon glyphicon-eye-open'></span>" +data[i].looktimes
					  +"<span class='glyphicon glyphicon-thumbs-up'></span>"+dianzantimes
					 +"</p></div></div><div class='clearfix'></div></div>")	;
				}
			});
		return;
	}
	$.getJSON("./article_getarticles?pageid="+pageid+"&rownums=6",
			function(data){
				for(var i=0;i<data.length;i++){
					var dianzantimes=0;
					$.get("./article_getdianzan?aid="+data[i].aid,null,function(data){
						dianzantimes = data;
					});
					$("#blogList").append("<div class='article'><div class='article-left'>"
					  +"<img src='images/t2.jpg'></div>"
					  +"<div class='article-right'>"
					  +"<div class='article-title'>"
					  +"<a class='title' href='content.html?aid="+data[i].aid+"&userid="+data[i].uid+"'>"+data[i].title+"</a></div>"
					  +"<div class='article-text'>"
					  +"<p>"+data[i].content+"</p>"
					  +"<p>On "+data[i].time.replace("T00:00:00"," ")+"</p>" 
					  +"<span class='glyphicon glyphicon-comment'></span>2"
					  +"<span class='glyphicon glyphicon-eye-open'></span>" +data[i].looktimes
					  +"<span class='glyphicon glyphicon-thumbs-up'></span>"+dianzantimes
					 +"</p></div></div><div class='clearfix'></div></div>")	;
				}
			});
}
function loadNextPage(){
	pageid=pageid+1;
	loadBlog();
}
function loadUpPage(){
 	pageid=pageid-1;
 	loadBlog();
}
 
function  loadGreatBlog(){
	loadBlog();
}

function loadTags(){
  //$("#tagList").empty();
  $.getJSON("./article_gettags",
  			function(data){
  				for(var i=0;i<data.length;i++){
  					//alert(data[i].content);
  					$("#tagList").append("<li><a id='"+data[i].content+"' class='btn btn-link' onclick='loadBlogByTag($(this))'><img src='img/label.ico'/>&nbsp;"+data[i].content+"</a></li>");	
  				}
  			});
}
function loadBlogByTag(id){
	var tag=id.attr("id");
	//alert(tag);
	$("#blogList").empty();
	$.getJSON("./article_getarticlesbytag?tag="+tag,
			function(data){
				for(var i=0;i<data.length;i++){
					var dianzantimes=0;
					$.get("./article_getdianzan?aid="+data[i].aid,null,function(data){
						dianzantimes = data;
					});
					$("#blogList").append("<div class='article'><div class='article-left'>"
					  +"<img src='images/t2.jpg'></div>"
					  +"<div class='article-right'>"
					  +"<div class='article-title'>"
					  +"<a class='title' href='content.html?aid="+data[i].aid+"&userid="+data[i].uid+"'>"+data[i].title+"</a></div>"
					  +"<div class='article-text'>"
					  +"<p>"+data[i].content+"</p>"
					  +"<p>On "+data[i].time.replace("T"," ")+"</p>" 
					  +"<span class='glyphicon glyphicon-comment'></span>2"
					  +"<span class='glyphicon glyphicon-eye-open'></span>" +data[i].looktimes
					  +"<span class='glyphicon glyphicon-thumbs-up'></span>"+dianzantimes
					 +"</p></div></div><div class='clearfix'></div></div>")	;
				}
			});	
}
</script>
</html>